# Change the OMSL fields of the timing filters according to the local PV that
# allows or blocks the global PV access.
record(dfanout, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_FANOUTNOGLOBAL1")
{
    field(DESC, "Fanouts OMSL to PVs")
    field(DOL, "$(DEVICE):$(SERVICE)_NOGLOBAL CP")
    field(OUTA, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_ACQ.OMSL")
    field(OUTB, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_RATEMODE.OMSL")
    field(OUTC, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_EXPSEQ.OMSL")
    field(OUTD, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_FIXEDRATE.OMSL")
    field(OUTE, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_ACRATE.OMSL")
    field(OUTF, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_TSLOTMASK.OMSL")
    field(OUTG, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_EXPSEQBIT.OMSL")
    field(OUTH, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_DESTMODE.OMSL")
    field(OMSL, "closed_loop")
}

record(dfanout, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_FANOUTNOGLOBAL2")
{
    field(DESC, "Fanouts OMSL to PVs")
    field(DOL, "$(DEVICE):$(SERVICE)_NOGLOBAL CP")
    field(OUTA, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_DESTMASK.OMSL")
    field(OUTB, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_RATELIMIT.OMSL")
    field(OMSL, "closed_loop")
}

record(bo, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_ACQ")
{
    field(DESC, "enable/disable for $(SERVICE) BUFF $(BUFF_NUM)")
    field(PINI, "YES")
    field(DTYP, "asynInt32")
    field(OUT, "@asyn($(PORT),0) $(SERVICE)_edefEnable_$(DRV_NUM)")
    field(DOL, "$(GLOBAL):$(BUFF_NUM):ACQCTRL CPP NMS")
    field(OMSL, "closed_loop")
    field(ZNAM, "Disable")
    field(ONAM, "Enable")
    info(autosaveFields, "VAL")
}

record(mbbo, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_RATEMODE")
{
    field(DESC, "$(SERVICE) Rate Mode")
    field(PINI, "YES")
    field(DTYP, "asynInt32")
    field(OUT, "@asyn($(PORT),0) $(SERVICE)_rateMode_$(DRV_NUM)")
    field(DOL, "$(GLOBAL):$(BUFF_NUM):RATEMODE_SET CPP NMS")
    field(OMSL, "closed_loop")
    field(SCAN, "Passive")
    field(ZRVL, "0")
    field(ONVL, "1")
    field(TWVL, "2")
    field(ZRST, "Fixed Rate")
    field(ONST, "AC Rate")
    field(TWST, "Exp Seq")
    info(autosaveFields, "VAL")
}

record(longout, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_EXPSEQ")
{
    field(DESC, "$(SERVICE) Exp Sequence Mode")
    field(PINI, "YES")
    field(DTYP, "asynInt32")
    field(OUT,  "@asyn($(PORT),0) $(SERVICE)_expSeqNum_$(DRV_NUM)")
    field(DOL, "$(GLOBAL):$(BUFF_NUM):EXPSEQ_SET CPP NMS")
    field(OMSL, "closed_loop")
    field(SCAN, "Passive")
    info(autosaveFields, "VAL")
}

record(mbbo, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_FIXEDRATE")
{
    field(DESC, "$(SERVICE) Fixed Rate Controls")
    field(PINI, "YES")
    field(DTYP, "asynInt32")
    field(OUT, "@asyn($(PORT),0) $(SERVICE)_fixedRate_$(DRV_NUM)")
    field(DOL, "$(GLOBAL):$(BUFF_NUM):FIXEDRATE_SET CPP NMS")
    field(SCAN, "Passive")
    field(OMSL, "closed_loop")
    field(ZRVL, "0")
    field(ONVL, "1")
    field(TWVL, "2")
    field(THVL, "3")
    field(FRVL, "4")
    field(FVVL, "5")
    field(SXVL, "6")
    field(ZRST, "1Hz")
    field(ONST, "10Hz")
    field(TWST, "100Hz")
    field(THST, "1kHz")
    field(FRST, "10kHz")
    field(FVST, "71.5kHz")
    field(SXST, "1MHz")
    info(autosaveFields, "VAL")
}

record(mbbo, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_ACRATE")
{
    field(DESC, "$(SERVICE) AC Rate Controls")
    field(PINI, "YES")
    field(DTYP, "asynInt32")
    field(OUT, "@asyn($(PORT),0) $(SERVICE)_acRate_$(DRV_NUM)")
    field(DOL, "$(GLOBAL):$(BUFF_NUM):ACRATE_SET CPP NMS")
    field(SCAN, "Passive")
    field(OMSL, "closed_loop")
    field(ZRVL, "0")
    field(ONVL, "1")
    field(TWVL, "2")
    field(THVL, "3")
    field(FRVL, "4")
    field(FVVL, "5")
    field(ZRST, "0.5Hz")
    field(ONST, "1Hz")
    field(TWST, "5Hz")
    field(THST, "10Hz")
    field(FRST, "30Hz")
    field(FVST, "60Hz")
    info(autosaveFields, "VAL")
}

record(longout, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_TSLOTMASK")
{
    field(DESC, "$(SERVICE) Timeslot Mask")
    field(PINI, "YES")
    field(DTYP, "asynInt32")
    field(OUT,  "@asyn($(PORT),0) $(SERVICE)_tSlotMask_$(DRV_NUM)")
    field(DOL, "$(GLOBAL):$(BUFF_NUM):TSLOTMASK_SET CPP NMS")
    field(SCAN, "Passive")
    field(OMSL, "closed_loop")
    info(autosaveFields, "VAL")
}

record(longout, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_EXPSEQBIT")
{
    field(DESC, "$(SERVICE) Exp Sequence Bit")
    field(PINI, "YES")
    field(DTYP, "asynInt32")
    field(OUT, "@asyn($(PORT),0) $(SERVICE)_expSeqBit_$(DRV_NUM)")
    field(DOL, "$(GLOBAL):$(BUFF_NUM):EXPSEQBIT_SET CPP NMS")
    field(OMSL, "closed_loop")
    field(SCAN, "Passive")
    info(autosaveFields, "VAL")
}

record(mbbo, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_DESTMODE")
{
    field(DESC, "$(SERVICE) Destination Mode")
    field(PINI, "YES")
    field(DTYP, "asynInt32")
    field(OUT, "@asyn($(PORT),0) $(SERVICE)_destMode_$(DRV_NUM)")
    field(DOL, "$(GLOBAL):$(BUFF_NUM):DESTMODE_SET CPP NMS")
    field(OMSL, "closed_loop")
    field(SCAN, "Passive")
    field(ZRVL, "0")
    field(ONVL, "1")
    field(TWVL, "2")
    field(ZRST, "Disable")
    field(ONST, "Exclusion")
    field(TWST, "Inclusion")
    info(autosaveFields, "VAL")
}

record(longout, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_DESTMASK")
{
    field(DESC, "$(SERVICE) Destinatin Mask")
    field(PINI, "YES")
    field(DTYP, "asynInt32")
    field(OUT, "@asyn($(PORT),0) $(SERVICE)_destMask_$(DRV_NUM)")
    field(DOL, "$(GLOBAL):$(BUFF_NUM):DESTMASK_SET CPP NMS")
    field(OMSL, "closed_loop")
    field(SCAN, "Passive")
    info(autosaveFields, "VAL")
}


record(mbbo, "$(DEVICE):$(SERVICE)$(BUFF_NUM)_RATELIMIT")
{
    field(DESC, "$(SERVICE) Rate Limit")
    field(PINI, "YES")
    field(DTYP, "asynInt32")
    field(OUT, "@asyn($(PORT), 0) $(SERVICE)_rateLimit_$(DRV_NUM)")
    field(DOL, "$(GLOBAL):$(BUFF_NUM):RATELIMIT_SET CPP NMS")
    field(OMSL, "closed_loop")
    field(SCAN, "Passive")
    field(ZRVL, "31")
    field(ONVL, "30")
    field(TWVL, "29")
    field(THVL, "28")
    field(FRVL, "27")
    field(FVVL, "26")
    field(SXVL, "25")
    field(SVVL, "24")
    field(EIVL, "23")
    field(NIVL, "22")
    field(TEVL, "21")
    field(ELVL, "20")
    field(TVVL, "19")
#    field(TTVL, "")
#    field(FTVL, "")
#    field(FFVL, "")
    field(ZRST, "0.5Hz")
    field(ONST, "0.9Hz")
    field(TWST, "1.8Hz")
    field(THST, "3.7Hz")
    field(FRST, "7Hz")
    field(FVST, "14Hz")
    field(SXST, "29Hz")
    field(SVST, "59Hz")
    field(EIST, "119Hz")
    field(NIST, "238Hz")
    field(TEST, "476Hz")
    field(ELST, "950Hz")
    field(TVST, "1.9kHz")
#    field(TTST, "")
#    field(FTST, "")
#    field(FFST, "")
    info(autosaveFields, "VAL")
}


